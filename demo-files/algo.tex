\begin{algorithm}[H]
\caption {ClusterInvitation()}\label{number3}
\begin {algorithmic}[1]
\FORALL {$\node \in {\cal N}$}
\STATE {$\node . hop=0$}
\STATE {$\node. inviter=0$}
\ENDFOR
\FORALL{$\node \in {\cal N}$}
\IF {$\node.CH=yes$}
	\STATE{Broadcast invitation} 
	\FORALL {$\mbox{nodes in the hearing range}$}
		\IF{ $\node$ hears $\node'$ {AND}  $\node. inviter=0$}
			\STATE $ \node.inviter =\node'$ information 
		\ENDIF
	\ENDFOR
\ELSE
\IF{$\node.inviter\ne 0$ {\bf AND} $\node.inviter.hop+1<K$}
\STATE{$\node.hop=\node.inviter.hop+1$}
\STATE{$\mbox {Broadcast invitation with } \node.Sig_{sk, Manufacturer}(\node.Pub_{Key}\mbox{ , } \node.ID)$, $ \mbox{nodes in the hearing} \rightarrow \node.inviter=1$}
\ENDIF
\ENDIF
\ENDFOR

\FORALL {$\node \in N$}
\IF {$\node.inviter=0$}
\STATE{\node.CH=Yes}
\ENDIF
\ENDFOR

\FORALL {$\node \in N$}
\IF{$\node.inviter=0$}
\STATE{\node.CH=Yes}
\ELSE
\STATE{$\mbox{Send the acceptance to } \node.inviter \mbox{ with }$ 

{\color {white} xxxxxxxx} $\node.Sig_{pk, Manufacturer}(\node.Pub_{Key}\mbox{, } \node.ID)$}

\ENDIF
\ENDFOR
\end{algorithmic}
\end{algorithm}